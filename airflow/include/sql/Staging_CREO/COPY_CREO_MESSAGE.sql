SELECT
    [MESSAGE_KEY], 
    REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE([SUBJECT], CHAR(237), N'i'), CHAR(146), ''), CHAR(150), ''), '^', ''), '|', ' '), '\', ' ') AS [SUBJECT],
    [DATE_ENTERED], 
    [DATE_SENT], 
    REPLACE(REPLACE(REPLACE(REPLACE(REPLACE([EXCEPTION],CHAR(10),''),CHAR(13),''), '^', ''), '|', ' '), '\', ' ') AS [EXCEPTION],
    [CONTAINER_KEY], 
    [COMMUNICATION_MAILING_KEY], 
    [TEMPLATE_KEY], 
    [IS_PRODUCTION], 
    [DATASET_ROW_KEY], 
    [SERVER], 
    [MESSAGE_ID], 
    [TYPE], 
    [NUM_EXCEPTIONS], 
    [DELIVERY_STATUS_KEY], 
    [IN_REPLY_TO_MESSAGE_KEY], 
    [DIRECTION], 
    [SEND_AFTER], 
    [SEND_AFTER_MESSAGE_KEY], 
    [IS_FINISHED], 
    REPLACE(REPLACE(REPLACE(REPLACE(REPLACE([HEADERS],CHAR(10),''),CHAR(13),''), '^', ''), '|', ' '), '\', ' ') AS [HEADERS],
    [VENDOR_ID]
FROM [dbo].[Message]
WHERE CAST([DATE_ENTERED] AS DATE) = CAST('{asOfDate}' AS DATE);

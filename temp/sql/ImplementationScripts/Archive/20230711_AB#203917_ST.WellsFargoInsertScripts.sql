insert into STG.WellsFargo_BAI_Bank_HIST (
    select METADATA$FILENAME as FILENAME
    , METADATA$FILE_LAST_MODIFIED as FILE_LAST_MODIFIED
    , to_date(current_timestamp()) as DATE_LOADED
    , METADATA$FILE_ROW_NUMBER AS FILE_ROW_NUMBER
    , etl.$1
    , etl.$2
    , etl.$3
    , etl.$4
    , etl.$5
    , etl.$6
    , etl.$7
    , etl.$8
    , etl.$9
    , etl.$10
    from @ETL.INBOUND/SmartTreasury/2023 etl
    where filename not in (
        select filename from stg.WellsFargo_BAI_Bank_HIST
    )
);

-- loading historical data in transaction details
insert into FIN.WellsFargo_BAI_TransactionDetails_HIST (
    with acct_num as (
        select file_row_number + 1 as File_Row_num_H, 
        LEAD(FILE_ROW_NUMBER) OVER (PARTITION BY FILENAME, COLUMN1 ORDER BY FILE_ROW_NUMBER) - 1 AS File_Row_num_F,
        LEAD(FILE_ROW_NUMBER) OVER (PARTITION BY FILENAME, COLUMN1 ORDER BY FILE_ROW_NUMBER) AS File_Row_num_L, 
        *
        from stg.WellsFargo_BAI_Bank_HIST 
        where column1 = 03 
        order by filename, file_row_number
    )
    , orig_date as (
        select to_date(COLUMN5, 'YYMMDD') as date, 
        filename 
        from stg.WellsFargo_BAI_Bank_HIST 
        where COLUMN1 = 02 
        order by filename, file_row_number
    )
    SELECT distinct 
    bh.FILENAME,
    bh.LOADTIMESTAMP,
    bh.ASOFDATE,
    bh.FILE_ROW_NUMBER,
    o.date as "Origination Date",
    ad.column2 cust_acc_number,
    bh.COLUMN1,
    bh.COLUMN2,
    bh.COLUMN3,
    bh.COLUMN4,
    cast((bh.column5 / 100) as decimal(34,2)) as "Amount",
    bh.COLUMN6,
    bh.COLUMN7,
    bh.COLUMN8,
    bh.COLUMN9
    FROM stg.WellsFargo_BAI_Bank_HIST bh
    Left join acct_num ad on ad.filename = bh.filename
    Left join orig_date o on o.filename = ad.filename
    where bh.FILE_ROW_NUMBER between ad.File_Row_num_H and ad.File_Row_num_F
    and bh.column1 = 16
    and bh.filename in (select filename from stg.WellsFargo_BAI_Bank_HIST)
    order by bh.filename, bh.file_row_number
);

--loading historical data into account header table
insert into FIN.WellsFargo_BAI_AccountHeaderDetails_HIST (
    select * from stg.WellsFargo_BAI_Bank_HIST 
    where COLUMN1 = 03 
    and filename in (
        select filename 
        from stg.WellsFargo_BAI_Bank_HIST
    ) 
    order by file_row_number
);

insert into fin.wellsfargo_bai_transactiondetails_lkp (
select filename, file_row_number, ORIGINATION_DATE, cust_acc_number, column2 as record_code,
case 
    when column2 = '010' then 'Opening Ledger '
    when column2 = '011' then 'Average Opening Ledger MTD '
    when column2 = '012' then 'Average Opening Ledger YTD '
    when column2 = '015' then 'Closing Ledger '
    when column2 = '020' then 'Average Closing Ledger MTD '
    when column2 = '021' then 'Average Closing Ledger – Previous Month '
    when column2 = '022' then 'Aggregate Balance Adjustments '
    when column2 = '024' then 'Average Closing Ledger YTD – Previous Month '
    when column2 = '025' then 'Average Closing Ledger YTD '
    when column2 = '030' then 'Current Ledger '
    when column2 = '037' then 'ACH Net Position '
    when column2 = '039' then 'Opening Available + Total Same-Day ACH DTC Deposit '
    when column2 = '040' then 'Opening Available '
    when column2 = '041' then 'Average Opening Available MTD '
    when column2 = '042' then 'Average Opening Available YTD '
    when column2 = '043' then 'Average Available – Previous Month '
    when column2 = '044' then 'Disbursing Opening Available Balance '
    when column2 = '045' then 'Closing Available '
    when column2 = '050' then 'Average Closing Available MTD '
    when column2 = '051' then 'Average Closing Available – Last Month '
    when column2 = '054' then 'Average Closing Available YTD – Last Month '
    when column2 = '055' then 'Average Closing Available YTD '
    when column2 = '056' then 'Loan Balance '
    when column2 = '057' then 'Total Investment Position '
    when column2 = '059' then 'Current Available (CRS Supressed) '
    when column2 = '060' then 'Current Available '
    when column2 = '061' then 'Average Current Available MTD '
    when column2 = '062' then 'Average Current Available YTD '
    when column2 = '063' then 'Total Float '
    when column2 = '065' then 'Target Balance '
    when column2 = '066' then 'Adjusted Balance '
    when column2 = '067' then 'Adjusted Balance MTD '
    when column2 = '068' then 'Adjusted Balance YTD '
    when column2 = '070' then '0-Day Float '
    when column2 = '072' then '1-Day Float '
    when column2 = '073' then 'Float Adjustment '
    when column2 = '074' then '2 or More Days Float '
    when column2 = '075' then '3 or More Days Float '
    when column2 = '076' then 'Adjustment to Balances '
    when column2 = '077' then 'Average Adjustment to Balances MTD '
    when column2 = '078' then 'Average Adjustment to Balances YTD '
    when column2 = '079' then '4-Day Float '
    when column2 = '080' then '5-Day Float '
    when column2 = '081' then '6-Day Float '
    when column2 = '082' then 'Average 1-Day Float MTD '
    when column2 = '083' then 'Average 1-Day Float YTD '
    when column2 = '084' then 'Average 2-Day Float MTD '
    when column2 = '085' then 'Average 2-Day Float YTD '
    when column2 = '086' then 'Transfer Calculation '
    when column2 = '100' then 'Total Credits '
    when column2 = '101' then 'Total Credit Amount MTD '
    when column2 = '105' then 'Credits Not Detailed '
    when column2 = '106' then 'Deposits Subject to Float '
    when column2 = '107' then 'Total Adjustment Credits YTD '
    when column2 = '108' then 'Credit (Any Type) '
    when column2 = '109' then 'Current Day Total Lockbox Deposits '
    when column2 = ' ' then ''
    when column2 = 'Lockbox – Related Type Codes' then ''
    when column2 = ' ' then ''
    when column2 = 'Type Code ' then 'Description '
    when column2 = '110' then 'Total Lockbox Deposits '
    when column2 = '115' then 'Lockbox Deposit '
    when column2 = '116' then 'Item in Lockbox Deposit '
    when column2 = '118' then 'Lockbox Adjustment Credit '
    when column2 = '120' then 'EDI* Transaction Credit '
    when column2 = '121' then 'EDI Transaction Credit '
    when column2 = '122' then 'EDIBANX Credit Received '
    when column2 = '123' then 'EDIBANX Credit Return '
    when column2 = '130' then 'Total Concentration Credits '
    when column2 = '131' then 'Total DTC Credits '
    when column2 = '135' then 'DTC Concentration Credit '
    when column2 = '136' then 'Item in DTC Deposit '
    when column2 = '140' then 'Total ACH Credits '
    when column2 = '142' then 'ACH Credit Received '
    when column2 = '143' then 'Item in ACH Deposit '
    when column2 = '145' then 'ACH Concentration Credit '
    when column2 = '146' then 'Total Bank Card Deposits '
    when column2 = '147' then 'Individual Bank Card Deposit '
    when column2 = '150' then 'Total Preauthorized Payment Credits '
    when column2 = '155' then 'Preauthorized Draft Credit '
    when column2 = '156' then 'Item in PAC Deposit '
    when column2 = '160' then 'Total ACH Disbursing Funding Credits '
    when column2 = '162' then 'Corporate Trade Payment Settlement '
    when column2 = '163' then 'Corporate Trade Payment Credits '
    when column2 = '164' then 'Corporate Trade Payment Credit '
    when column2 = '165' then 'Preauthorized ACH Credit '
    when column2 = '166' then 'ACH Settlement '
    when column2 = '167' then 'ACH Settlement Credits '
    when column2 = '168' then 'ACH Return Item or Adjustment Settlement '
    when column2 = '169' then 'Miscellaneous ACH Credit '
    when column2 = '170' then 'Total Other Check Deposits '
    when column2 = '171' then 'Individual Loan Deposit '
    when column2 = '172' then 'Deposit Correction '
    when column2 = '173' then 'Bank-Prepared Deposit '
    when column2 = '174' then 'Other Deposit '
    when column2 = '175' then 'Check Deposit Package '
    when column2 = '176' then 'Re-presented Check Deposit '
    when column2 = '178' then 'List Post Credits '
    when column2 = '180' then 'Total Loan Proceeds '
    when column2 = 'Type Code ' then 'Description  '
    when column2 = '182' then 'Total Bank-Prepared Deposits '
    when column2 = '184' then 'Draft Deposit '
    when column2 = '185' then 'Total Miscellaneous Deposits '
    when column2 = '186' then 'Total Cash Letter Credits '
    when column2 = '187' then 'Cash Letter Credit '
    when column2 = '188' then 'Total Cash Letter Adjustments '
    when column2 = '189' then 'Cash Letter Adjustment '
    when column2 = '190' then 'Total Incoming Money Transfers '
    when column2 = '191' then 'Individual Incoming Internal Money Transfer '
    when column2 = '195' then 'Incoming Money Transfer '
    when column2 = '196' then 'Money Transfer Adjustment '
    when column2 = '198' then 'Compensation '
    when column2 = '200' then 'Total Automatic Transfer Credits '
    when column2 = '201' then 'Individual Automatic Transfer Credit '
    when column2 = '202' then 'Bond Operations Credit '
    when column2 = '205' then 'Total Book Transfer Credits '
    when column2 = '206' then 'Book Transfer Credit '
    when column2 = '207' then 'Total International Money Transfer Credits '
    when column2 = '208' then 'Individual International Money Transfer Credit '
    when column2 = '210' then 'Total International Credits '
    when column2 = '212' then 'Foreign Letter of Credit '
    when column2 = '213' then 'Letter of Credit '
    when column2 = '214' then 'Foreign Exchange of Credit '
    when column2 = '215' then 'Total Letters of Credit '
    when column2 = '216' then 'Foreign Remittance Credit '
    when column2 = '218' then 'Foreign Collection Credit '
    when column2 = '221' then 'Foreign Check Purchase '
    when column2 = '222' then 'Foreign Checks Deposited '
    when column2 = '224' then 'Commission '
    when column2 = '226' then 'International Money Market Trading '
    when column2 = '227' then 'Standing Order '
    when column2 = '229' then 'Miscellaneous International Credit '
    when column2 = '230' then 'Total Security Credits '
    when column2 = '231' then 'Total Collection Credits '
    when column2 = '232' then 'Sale of Debt Security  '
    when column2 = '233' then 'Securities Sold '
    when column2 = '234' then 'Sale of Equity Security '
    when column2 = '235' then 'Matured Reverse Repurchase Order '
    when column2 = '236' then 'Maturity of Debt Security '
    when column2 = '237' then 'Individual Collection Credit '
    when column2 = '238' then 'Collection of Dividends '
    when column2 = '239' then 'Total Bankers’ Acceptance Credits '
    when column2 = '240' then 'Coupon Collections – Banks '
    when column2 = '241' then 'Bankers’ Acceptances '
    when column2 = '242' then 'Collection of Interest Income '
    when column2 = '243' then 'Matured Fed Funds Purchased '
    when column2 = '244' then 'Interest/Matured Principal Payment '
    when column2 = '245' then 'Monthly Dividends '
    when column2 = '246' then 'Commercial Paper '
    when column2 = '247' then 'Capital Change '
    when column2 = '248' then 'Savings Bonds Sales Adjustment '
    when column2 = '249' then 'Miscellaneous Security Credit '
    when column2 = '250' then 'Total Checks Posted and Returned '
    when column2 = '251' then 'Total Debit Reversals '
    when column2 = '252' then 'Debit Reversal '
    when column2 = '254' then 'Posting Error Correction Credit '
    when column2 = '255' then 'Check Posted and Returned '
    when column2 = '256' then 'Total ACH Return Items '
    when column2 = '257' then 'Individual ACH Return Item '
    when column2 = '258' then 'ACH Reversal Credit '
    when column2 = '260' then 'Total Rejected Credits '
    when column2 = '261' then 'Individual Rejected Credit '
    when column2 = '263' then 'Overdraft '
    when column2 = '266' then 'Return Item '
    when column2 = '268' then 'Return Item Adjustment '
    when column2 = '270' then 'Total ZBA Credits '
    when column2 = '271' then 'Net Zero-Balance Amount '
    when column2 = '274' then 'Cumulative** ZBA or Disbursement Credits '
    when column2 = '275' then 'ZBA Credit '
    when column2 = '276' then 'ZBA Float Adjustment '
    when column2 = '277' then 'ZBA Credit Transfer '
    when column2 = '278' then 'ZBA Credit Adjustment '
    when column2 = '280' then 'Total Controlled Disbursing Credits '
    when column2 = '281' then 'Individual Controlled Disbursing Credit '
    when column2 = '285' then 'Total DTC Disbursing Credits '
    when column2 = '286' then 'Individual DTC Disbursing Credit '
    when column2 = '294' then 'Total ATM Credits '
    when column2 = '295' then 'ATM Credit '
    when column2 = '301' then 'Commercial Deposit '
    when column2 = '302' then 'Correspondent Bank Deposit '
    when column2 = '303' then 'Total Wire Transfers In – FF '
    when column2 = '304' then 'Total Wire Transfers In – CHF '
    when column2 = '305' then 'Total Fed Funds Sold '
    when column2 = '306' then 'Fed Funds Sold '
    when column2 = '307' then 'Total Trust Credits '
    when column2 = '308' then 'Trust Credit '
    when column2 = '309' then 'Total Value - Dated Funds '
    when column2 = '310' then 'Total Commercial Deposits '
    when column2 = '315' then 'Total International Credits – FF '
    when column2 = '316' then 'Total International Credits – CHF '
    when column2 = '318' then 'Total Foreign Check Purchased '
    when column2 = '319' then 'Late Deposit '
    when column2 = '320' then 'Total Securities Sold – FF '
    when column2 = '321' then 'Total Securities Sold – CHF '
    when column2 = '324' then 'Total Securities Matured – FF '
    when column2 = '325' then 'Total Securities Matured – CHF '
    when column2 = '326' then 'Total Securities Interest '
    when column2 = '327' then 'Total Securities Matured '
    when column2 = '328' then 'Total Securities Interest – FF '
    when column2 = '329' then 'Total Securities Interest – CHF '
    when column2 = '330' then 'Total Escrow Credits '
    when column2 = '331' then 'Individual Escrow Credit '
    when column2 = '332' then 'Total Miscellaneous Securities Credits – FF '
    when column2 = '336' then 'Total Miscellaneous Securities Credits – CHF '
    when column2 = '338' then 'Total Securities Sold '
    when column2 = '340' then 'Total Broker Deposits '
    when column2 = '341' then 'Total Broker Deposits – FF '
    when column2 = '342' then 'Broker Deposit '
    when column2 = '343' then 'Total Broker Deposits – CHF '
    when column2 = '344' then 'Individual Back Value Credit '
    when column2 = '345' then 'Item in Brokers Deposit '
    when column2 = '346' then 'Sweep Interest Income '
    when column2 = '347' then 'Sweep Principal Sell '
    when column2 = '348' then 'Futures Credit '
    when column2 = '349' then 'Principal Payments Credit '
    when column2 = '350' then 'Investment Sold '
    when column2 = '351' then 'Individual Investment Sold '
    when column2 = '352' then 'Total Cash Center Credits '
    when column2 = '353' then 'Cash Center Credit '
    when column2 = '354' then 'Interest Credit '
    when column2 = '355' then 'Investment Interest '
    when column2 = '356' then 'Total Credit Adjustment '
    when column2 = '357' then 'Credit Adjustment '
    when column2 = '358' then 'YTD Adjustment Credit '
    when column2 = '359' then 'Interest Adjustment Credit '
    when column2 = '360' then 'Total Credits Less Wire Transfer and Returned Checks '
    when column2 = '361' then 'Grand Total Credits Less Grand Total Debits '
    when column2 = '362' then 'Correspondent Collection '
    when column2 = '363' then 'Correspondent Collection Adjustment '
    when column2 = '364' then 'Loan Participation '
    when column2 = '366' then 'Currency and Coin Deposited '
    when column2 = '367' then 'Food Stamp Letter '
    when column2 = '368' then 'Food Stamp Adjustment '
    when column2 = '369' then 'Clearing Settlement Credit '
    when column2 = '370' then 'Total Back Value Credits '
    when column2 = '372' then 'Back Value Adjustment '
    when column2 = '373' then 'Customer Payroll '
    when column2 = '374' then 'FRB Statement Recap '
    when column2 = '376' then 'Savings Bond Letter or Adjustment '
    when column2 = '377' then 'Treasury Tax and Loan Credit '
    when column2 = '378' then 'Transfer of Treasury Credit '
    when column2 = '379' then 'FRB Government Checks Cash Letter Credit '
    when column2 = '381' then 'FRB Government Check Adjustment '
    when column2 = '382' then 'FRB Postal Money Order Credit '
    when column2 = '383' then 'FRB Postal Money Order Adjustment '
    when column2 = '384' then 'FRB Cash Letter Auto Charge Credit '
    when column2 = '385' then 'Total Universal Credits '
    when column2 = '386' then 'FRB Cash Letter Auto Charge Adjustment '
    when column2 = '387' then 'FRB Fine-Sort Cash Letter Credit '
    when column2 = '388' then 'FRB Fine-Sort Adjustment '
    when column2 = '389' then 'Total Freight Payment Credits '
    when column2 = '390' then 'Total Miscellaneous Credits '
    when column2 = '391' then 'Universal Credit '
    when column2 = '392' then 'Freight Payment Credit '
    when column2 = '393' then 'Itemized Credit Over $10,000 '
    when column2 = '394' then 'Cumulative** Credits '
    when column2 = '395' then 'Check Reversal '
    when column2 = '397' then 'Float Adjustment '
    when column2 = '398' then 'Miscellaneous Fee Refund '
    when column2 = '399' then 'Miscellaneous Credit '
    when column2 = '400' then 'Total Debits '
    when column2 = '401' then 'Total Debit Amount MTD '
    when column2 = '403' then 'Today’s Total Debits '
    when column2 = '405' then 'Total Debit Less Wire Transfers and ChargeBacks '
    when column2 = '406' then 'Debits not Detailed '
    when column2 = '408' then 'Float Adjustment '
    when column2 = '409' then 'Debit (Any Type) '
    when column2 = '410' then 'Total YTD Adjustment '
    when column2 = '412' then 'Total Debits (Excluding Returned Items) '
    when column2 = '415' then 'Lockbox Debit '
    when column2 = '416' then 'Total Lockbox Debits '
    when column2 = '420' then 'EDI Transaction Debits '
    when column2 = '421' then 'EDI Transaction Debit '
    when column2 = '422' then 'EDIBANX Settlement Debit '
    when column2 = '423' then 'EDIBANX Return Item Debit '
    when column2 = '430' then 'Total Payable–Through Drafts '
    when column2 = '435' then 'Payable–Through Draft '
    when column2 = '445' then 'ACH Concentration Debit '
    when column2 = '446' then 'Total ACH Disbursement Funding Debits '
    when column2 = '447' then 'ACH Disbursement Funding Debit '
    when column2 = '450' then 'Total ACH Debits '
    when column2 = '451' then 'ACH Debit Received '
    when column2 = '452' then 'Item in ACH Disbursement or Debit '
    when column2 = '455' then 'Preauthorized ACH Debit '
    when column2 = '462' then 'Account Holder Initiated ACH Debit '
    when column2 = '463' then 'Corporate Trade Payment Debits '
    when column2 = 'Type Code ' then 'Description '
    when column2 = '464' then 'Corporate Trade Payment Debit '
    when column2 = '465' then 'Corporate Trade Payment Settlement '
    when column2 = '466' then 'ACH Settlement '
    when column2 = '467' then 'ACH Settlement Debits '
    when column2 = '468' then 'ACH Return Item or Adjustment Settlement '
    when column2 = '469' then 'Miscellaneous ACH Debit '
    when column2 = '470' then 'Total Check Paid '
    when column2 = '471' then 'Total Check Paid – Cumulative MTD '
    when column2 = '472' then 'Cumulative** Checks Paid '
    when column2 = '474' then 'Certified Check Debit '
    when column2 = '475' then 'Check Paid '
    when column2 = '476' then 'Federal Reserve Bank Letter Debit '
    when column2 = '477' then 'Bank Originated Debit '
    when column2 = '478' then 'List Post Debits '
    when column2 = '479' then 'List Post Debit '
    when column2 = '480' then 'Total Loan Payments '
    when column2 = '481' then 'Individual Loan Payment '
    when column2 = '482' then 'Total Bank-Originated Debits '
    when column2 = '484' then 'Draft '
    when column2 = '485' then 'DTC Debit '
    when column2 = '486' then 'Total Cash Letter Debits '
    when column2 = 'Type Code ' then 'Description '
    when column2 = '487' then 'Cash Letter Debit '
    when column2 = '489' then 'Cash Letter Adjustment '
    when column2 = '490' then 'Total Outgoing Money Transfers '
    when column2 = '491' then 'Individual Outgoing Internal Money Transfer '
    when column2 = '493' then 'Customer Terminal Initiated Money Transfer '
    when column2 = '495' then 'Outgoing Money Transfer '
    when column2 = '496' then 'Money Transfer Adjustment '
    when column2 = '498' then 'Compensation '
    when column2 = '500' then 'Total Automatic Transfer Debits '
    when column2 = '501' then 'Individual Automatic Transfer Debit '
    when column2 = '502' then 'Bond Operations Debit '
    when column2 = '505' then 'Total Book Transfer Debits '
    when column2 = '506' then 'Book Transfer Debit '
    when column2 = '507' then 'Total International Money Transfer Debits '
    when column2 = '508' then 'Individual International Money Transfer Debits '
    when column2 = '510' then 'Total International Debits '
    when column2 = '512' then 'Letter of Credit Debit '
    when column2 = '513' then 'Letter of Credit '
    when column2 = '514' then 'Foreign Exchange Debit '
    when column2 = '515' then 'Total Letters of Credit '
    when column2 = '516' then 'Foreign Remittance Debit '
    when column2 = '518' then 'Foreign Collection Debit '
    when column2 = '522' then 'Foreign Checks Paid '
    when column2 = '524' then 'Commission '
    when column2 = '526' then 'International Money Market Trading '
    when column2 = '527' then 'Standing Order '
    when column2 = '529' then 'Miscellaneous International Debit '
    when column2 = '530' then 'Total Security Debits '
    when column2 = '531' then 'Securities Purchased '
    when column2 = '532' then 'Total Amount of Securities Purchased '
    when column2 = '533' then 'Security Collection Debit '
    when column2 = '534' then 'Total Miscellaneous Securities DB – FF '
    when column2 = '535' then 'Purchase of Equity Securities '
    when column2 = '536' then 'Total Miscellaneous Securities Debit – CHF '
    when column2 = '537' then 'Total Collection Debit '
    when column2 = '538' then 'Matured Repurchase Order '
    when column2 = '539' then 'Total Bankers’ Acceptances Debit '
    when column2 = '540' then 'Coupon Collection Debit '
    when column2 = '541' then 'Bankers’ Acceptances '
    when column2 = '542' then 'Purchase of Debt Securities '
    when column2 = '543' then 'Domestic Collection '
    when column2 = '544' then 'Interest/Matured Principal Payment '
    when column2 = '546' then 'Commercial paper '
    when column2 = '547' then 'Capital Change '
    when column2 = 'Type Code ' then 'Description '
    when column2 = '548' then 'Savings Bonds Sales Adjustment '
    when column2 = '549' then 'Miscellaneous Security Debit '
    when column2 = '550' then 'Total Deposited Items Returned '
    when column2 = '551' then 'Total Credit Reversals '
    when column2 = '552' then 'Credit Reversal '
    when column2 = '554' then 'Posting Error Correction Debit '
    when column2 = '555' then 'Deposited Item Returned '
    when column2 = '556' then 'Total ACH Return Items '
    when column2 = '557' then 'Individual ACH Return Item '
    when column2 = '558' then 'ACH Reversal Debit '
    when column2 = '560' then 'Total Rejected Debits '
    when column2 = '561' then 'Individual Rejected Debit '
    when column2 = '563' then 'Overdraft '
    when column2 = '564' then 'Overdraft Fee '
    when column2 = '566' then 'Return Item '
    when column2 = '567' then 'Return Item Fee '
    when column2 = '568' then 'Return Item Adjustment '
    when column2 = '570' then 'Total ZBA Debits '
    when column2 = '574' then 'Cumulative ZBA Debits '
    when column2 = '575' then 'ZBA Debit '
    when column2 = '577' then 'ZBA Debit Transfer '
    when column2 = '578' then 'ZBA Debit Adjustment '
    when column2 = '580' then 'Total Controlled Disbursing Debits '
    when column2 = '581' then 'Individual Controlled Disbursing Debit '
    when column2 = '583' then 'Total Disbursing Checks Paid – Early Amount '
    when column2 = '584' then 'Total Disbursing Checks Paid – Later Amount '
    when column2 = '585' then 'Disbursing Funding Requirement '
    when column2 = '586' then 'FRB Presentment Estimate (Fed Estimate) '
    when column2 = '587' then 'Late Debits (After Notification) '
    when column2 = '588' then 'Total Disbursing Checks Paid-Last Amount '
    when column2 = '590' then 'Total DTC Debits '
    when column2 = '594' then 'Total ATM Debits '
    when column2 = '595' then 'ATM Debit '
    when column2 = '596' then 'Total APR Debits '
    when column2 = '597' then 'ARP Debit '
    when column2 = '601' then 'Estimated Total Disbursement '
    when column2 = '602' then 'Adjusted Total Disbursement '
    when column2 = '610' then 'Total Funds Required '
    when column2 = '611' then 'Total Wire Transfers Out- CHF '
    when column2 = '612' then 'Total Wire Transfers Out – FF '
    when column2 = '613' then 'Total International Debit – CHF '
    when column2 = '614' then 'Total International Debit – FF '
    when column2 = '615' then 'Total Federal Reserve Bank – Commercial Bank Debit '
    when column2 = '616' then 'Federal Reserve Bank – Commercial Bank Debit '
    when column2 = '617' then 'Total Securities Purchased – CHF '
    when column2 = '618' then 'Total Securities Purchased – FF '
    when column2 = '621' then 'Total Broker Debits – CHF '
    when column2 = '622' then 'Broker Debit '
    when column2 = '623' then 'Total Broker Debits – FF '
    when column2 = '625' then 'Total Broker Debits '
    when column2 = '626' then 'Total Fed Funds Purchased '
    when column2 = '627' then 'Fed Funds Purchased '
    when column2 = '628' then 'Total Cash Center Debits '
    when column2 = '629' then 'Cash Center Debit '
    when column2 = '630' then 'Total Debit Adjustments '
    when column2 = '631' then 'Debit Adjustment '
    when column2 = '632' then 'Total Trust Debits '
    when column2 = '633' then 'Trust Debit '
    when column2 = '634' then 'YTD Adjustment Debit '
    when column2 = '640' then 'Total Escrow Debits '
    when column2 = '641' then 'Individual Escrow Debit '
    when column2 = '644' then 'Individual Back Value Debit '
    when column2 = '646' then 'Transfer Calculation Debit '
    when column2 = '650' then 'Investments Purchased '
    when column2 = '651' then 'Individual Investment purchased '
    when column2 = '654' then 'Interest Debit '
    when column2 = '655' then 'Total Investment Interest Debits '
    when column2 = '656' then 'Sweep Principal Buy '
    when column2 = '657' then 'Futures Debit '
    when column2 = '658' then 'Principal Payments Debit '
    when column2 = '659' then 'Interest Adjustment Debit '
    when column2 = '661' then 'Account Analysis Fee '
    when column2 = '662' then 'Correspondent Collection Debit '
    when column2 = '663' then 'Correspondent Collection Adjustment '
    when column2 = '664' then 'Loan Participation '
    when column2 = '665' then 'Intercept Debits '
    when column2 = '666' then 'Currency and Coin Shipped '
    when column2 = '667' then 'Food Stamp Letter '
    when column2 = '668' then 'Food Stamp Adjustment '
    when column2 = '669' then 'Clearing Settlement Debit '
    when column2 = '670' then 'Total Back Value Debits '
    when column2 = '672' then 'Back Value Adjustment '
    when column2 = '673' then 'Customer Payroll '
    when column2 = '674' then 'FRB Statement Recap '
    when column2 = '676' then 'Savings Bond Letter or Adjustment '
    when column2 = '677' then 'Treasury Tax and Loan Debit '
    when column2 = '678' then 'Transfer of Treasury Debit '
    when column2 = '679' then 'FRB Government Checks Cash Letter Debit '
    when column2 = '681' then 'FRB Government Check Adjustment '
    when column2 = '682' then 'FRB Postal Money Order Debit '
    when column2 = '683' then 'FRB Postal Money Order Adjustment '
    when column2 = '684' then 'FRB Cash Letter Auto Charge Debit '
    when column2 = '685' then 'Total Universal Debits '
    when column2 = '686' then 'FRB Cash Letter Auto Charge Adjustment '
    when column2 = '687' then 'FRB Fine-Sort Cash Letter Debit '
    when column2 = '688' then 'FRB Fine-Sort Adjustment '
    when column2 = '689' then 'FRB Freight Payment Debits '
    when column2 = '690' then 'Total Miscellaneous Debits '
    when column2 = '691' then 'Universal Debit '
    when column2 = '692' then 'Freight Payment Debit '
    when column2 = '693' then 'Itemized Debit Over $10,000 '
    when column2 = '694' then 'Deposit Reversal '
    when column2 = '695' then 'Deposit Correction Debit '
    when column2 = '696' then 'Regular Collection Debit '
    when column2 = '697' then 'Cumulative** Debits '
    when column2 = '698' then 'Miscellaneous Fees '
    when column2 = '699' then 'Miscellaneous Debit '
    when column2 = '701' then 'Principal Loan Balance '
    when column2 = '703' then 'Available Commitment Amount '
    when column2 = '705' then 'Payment Amount Due '
    when column2 = '707' then 'Principal Amount Past Due '
    when column2 = '709' then 'Interest Amount Past Due '
    when column2 = '720' then 'Total Loan Payment '
    when column2 = '721' then 'Amount Applied to Interest '
    when column2 = '722' then 'Amount Applied to Principal '
    when column2 = '723' then 'Amount Applied to Escrow '
    when column2 = '724' then 'Amount Applied to Late Charges '
    when column2 = '725' then 'Amount Applied to Buydown '
    when column2 = '726' then 'Amount Applied to Misc. Fees '
    when column2 = '727' then 'Amount Applied to Deferred Interest Detail '
    when column2 = '728' then 'Amount Applied to Service Charge '
    when column2 = '760' then 'Loan Disbursement '
    when column2 = '890' then 'Contains Non-monetary Information '
end as tran_desc
from FIN.wellsfargo_bai_transactions_16_VW
);